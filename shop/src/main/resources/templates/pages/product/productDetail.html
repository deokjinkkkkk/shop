<!-- upload.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/layout}"
      layout:fragment="Content">
<head>
      <!--Common Head-->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta name="viewport"
              content="width=device-width, maximum-scale=1.0, minimum-scale=1, user-scalable=yes,initial-scale=1.0"/>
        
      </head>
      
      
    <div class="title-wrapper">
     	<div class="container">
      		<div class="container-inner">
		       
     	 	</div>
      	</div>
    </div>

    <div class="main">
      <div class="container">
       <ul class="breadcrumb">
		<li><a href="/">Home</a></li>
	      <li class="active" id="link">책상</li>
	  </ul>
        <!-- BEGIN SIDEBAR & CONTENT -->
        <div class="row margin-bottom-40">
          <!-- BEGIN SIDEBAR -->
	      <div class="sidebar col-md-3 col-sm-5">
	        <ul class="list-group margin-bottom-25 sidebar-menu">
              <li class="list-group-item clearfix" th:each="category : ${categories}" th:classappend="${category.selected == 1 ? 'dropdown active' : ''}">
                <a th:href="@{/product/list(category=${category.categoryNum})}" >
                  <i class="fa fa-angle-right"></i> [[${category.categoryName}]]
                </a>
                <input type="hidden" id="selCateogry" th:value="${category.categoryNum}" th:if="${category.selected == 1 }">
                <input type="hidden" id="catName" th:value="${category.categoryName}" th:if="${category.selected == 1 }">
              </li>
            </ul>
	      </div>
          <!-- END SIDEBAR -->
         
           <!-- BEGIN CONTENT -->
          <div class="col-md-9 col-sm-7">
            <div class="product-page">
            	<form method="post" id="cartInsert" action="/product/cartInsert">
	              <div class="row" th:each="pr : ${pro}">
	                <div class="col-md-6 col-sm-6">
	                  <div class="product-main-image">
	                    <img th:src="'/image/'+${pr.proImg1}" th:alt="${pr.proName}" class="img-responsive">
	                  </div>
	                  <div class="product-other-images">
	                    <a href="'/image/'+${pr.proImg2}" class="fancybox-button" rel="photos-lib"><img alt="Berry Lace Dress" th:src="'/image/'+${pr.proImg2}"></a>
	                    <a href="'/image/'+${pr.proImg3}" class="fancybox-button" rel="photos-lib"><img alt="Berry Lace Dress" th:src="'/image/'+${pr.proImg3}"></a>
	                  </div>
	                </div>
	                <div class="col-md-6 col-sm-6">
	                  <h1 th:text="${pr.proName}">Cool green dress with red bell</h1>
	                  <div class="price-availability-block clearfix">
	                    <div class="price">
	                      <strong th:text="${pr.proPrice}"><span>원</span></strong>
	                      <em><span th:text="${pr.proPrice}">62.00</span>원</em>
	                    </div>
	                    <div class="availability">
	                      Availability: <strong>In Stock</strong>
	                    </div>
	                  </div>
	                  <div class="description">
	                    <p th:text=${pr.proContent}></p>
	                  </div>
	                 
	                  <div class="product-page-cart">
	                    <div class="product-quantity">
	                        <input id="cnt" name="proCnt" type="text" value="1" readonly class="form-control">
	                    </div>            
	                    <input type="hidden" th:value="${pr.productNum}" name="productNum" id="productNum">
	                    <button class="btn btn-primary" id="cartBtn" type="button">장바구니 담기</button>
	                    <button class="btn btn-primary" id="orderBtn" type="button">주문하기</button>
	                    <button class="btn btn-primary" th:if="${#strings.equals(session.roles,'[ROLE_ADMIN]')}" type="button" id="updateBtn">상품수정</button>
	                    <button class="btn btn-primary" th:if="${#strings.equals(session.roles,'[ROLE_ADMIN]')}" type="button" id="deleteBtn">상품삭제</button>
	                  </div> 
	                  </div>
	                </div>
				</form>
                <div class="product-page-content">
                  <ul id="myTab" class="nav nav-tabs">                          
                    <li class="active"><a href="#Reviews" data-toggle="tab">Reviews (2)</a></li>
                  </ul>
                  <div id="myTabContent" class="tab-content">
                    <div class="tab-pane fade in active" id="Reviews">
                      <!--<p>There are no reviews for this product.</p>-->
                      <div class="review-item clearfix">
                        <div class="review-item-submitted">
                          <strong>Bob</strong>
                          <em>30/12/2013 - 07:37</em>
                          <div class="rateit" data-rateit-value="5" data-rateit-ispreset="true" data-rateit-readonly="true"></div>
                        </div>                                              
                        <div class="review-item-content">
                            <p>Sed velit quam, auctor id semper a, hendrerit eget justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Duis vel arcu pulvinar dolor tempus feugiat id in orci. Phasellus sed erat leo. Donec luctus, justo eget ultricies tristique, enim mauris bibendum orci, a sodales lectus purus ut lorem.</p>
                        </div>
                      </div>
                      <div class="review-item clearfix">
                        <div class="review-item-submitted">
                          <strong>Mary</strong>
                          <em>13/12/2013 - 17:49</em>
                          <div class="rateit" data-rateit-value="2.5" data-rateit-ispreset="true" data-rateit-readonly="true"></div>
                        </div>                                              
                        <div class="review-item-content">
                            <p>Sed velit quam, auctor id semper a, hendrerit eget justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Duis vel arcu pulvinar dolor tempus feugiat id in orci. Phasellus sed erat leo. Donec luctus, justo eget ultricies tristique, enim mauris bibendum orci, a sodales lectus purus ut lorem.</p>
                        </div>
                      </div>

                      <!-- BEGIN FORM-->
                      <form action="#" class="reviews-form" role="form">
                        <h2>Write a review</h2>
                        <div class="form-group">
                          <label for="name">Name <span class="require">*</span></label>
                          <input type="text" class="form-control" id="name">
                        </div>
                        <div class="form-group">
                          <label for="email">Email</label>
                          <input type="text" class="form-control" id="email">
                        </div>
                        <div class="form-group">
                          <label for="review">Review <span class="require">*</span></label>
                          <textarea class="form-control" rows="8" id="review"></textarea>
                        </div>
                        <div class="padding-top-20">                  
                          <button type="submit" class="btn btn-primary">Send</button>
                        </div>
                      </form>
                      <!-- END FORM--> 
                    </div>
                  </div>
                </div>
					<!-- 주문 form -->
			<form th:action="'/order/'+${session.email}" method="get" id="orderForm">
				<input type="hidden" name="orders[0].productNum" th:value="${pro.productNum}">
				<input type="hidden" name="orders[0].orderCnt" value="">
			</form>
			
                <div class="sticker sticker-sale"></div>
              </div>
            </div>
          </div>
          <!-- END CONTENT -->
        </div>
        <!-- END SIDEBAR & CONTENT -->
      </div>
   </div>
      <script>
		$("#orderBtn").click("on",function(){
			var proCount = $("#cnt").val()
			$("#orderForm").find("input[name= 'orders[0].orderCnt']").val(proCount)
			$("#orderForm").submit();
		})
      	$("#updateBtn").click(function(){
      		var productNum = $("input[name=productNum]").val()
      		location.href = "/product/updateForm?productNum=" + productNum
      	})
      	$("#deleteBtn").click(function(){
      		
			$("#cartInsert").attr("action", "/product/productDelete").submit();
      		
      	})
      	$("#cartBtn").click(function(e){
      		var cnt = $("#cnt").val();
      		console.log(cnt)
          	var productNumber = $("#productNum").val();
      		$.ajax({
      			url : '/cart/add',
      			type: 'POST',
      			data : {
      				cnt : cnt,
      				productNum : productNumber
      			},
      			success : function(result){
      				if(result == 0){
      					alert("장바구니에 추가를 하지 못하였습니다.")
      				}else if(result == 1){
      					alert("장바구니에 추가 하였습니다.")
      				}else if(result == 2){
      					alert("장바구니에 이미 상품이 있습니다.")
      				}else if(result == 3){
      					alert("로그인이 필요 합니다.")
      				}else if(result == 4){
      					alert("상품의 재고가 부족합니다.")
      				}
      			}
      		
      		})
      	})
      </script>
</html>
